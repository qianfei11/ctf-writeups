#!/usr/bin/env python
import gmpy2
import libnum

e = 0x10001
n1 = 0x1339BF81CEF8A0DF488D4764DAFFC1A30DCA6C61367CB3A27BB9C84667CFB90E0D613C0921B196E94CA07CE3E4F56AB3E58D8D1446018E03EAF89F3A55AA81
n2 = 0x52B207F2802A1C2157B847B420F0CF4F884EFD66E5F1C47B3D8561FCDD165E4C5CBC97E10DBE7C1CAB1826F0CE0DE54D4841FD6BBC3B34B90D5771700356F

p = gmpy2.gcd(n1, n2)
q1 = n1 / p
q2 = n2 / p

d1 = gmpy2.invert(e, (p - 1) * (q1 - 1))
d2 = gmpy2.invert(e, (p - 1) * (q2 - 1))

block1_c1 = 864826346328927043007924641380681736981324987926997370887020532699182309378599192043216478265476219278213123962074508284028662403643532629433329761492
block1_c2 = 259242051785557714557594066190019826465030870294179284671916925100489488841761299528416294893049464518482888070747927907550583942630013791833474340284
block1_m1 = gmpy2.powmod(block1_c1, d1, n1)
print libnum.n2s(block1_m1)
block1_m2 = gmpy2.powmod(block1_c2, d2, n2)
print libnum.n2s(block1_m2)

block2_c1 = 3467074671076858427887425157777463145087476633275513864943463990703623032280801013924306443879332057123214793127862390154827554625137418534583896303616
block2_c2 = 260259490441096686614518844301454718739843509738983969165420676005404297357230613482141235832583253831691051931351295653801889428212969414301414329852
block2_m1 = gmpy2.powmod(block2_c1, d1, n1)
print libnum.n2s(block2_m1)
block2_m2 = gmpy2.powmod(block2_c2, d2, n2)
print libnum.n2s(block2_m2)

block3_c1 = 1535086324597057729311343510271769159442400498252787851926410538373297030193590329732950032623600137243772129943527400615893561445637150940979108765230
block3_c2 = 182842058942028668693782090218012558408325328016978308589264490683273716484502724907545336344750909005728737352410277713521976130375761311818569486299
block3_m1 = gmpy2.powmod(block3_c1, d1, n1)
print libnum.n2s(block3_m1)
block3_m2 = gmpy2.powmod(block3_c2, d2, n2)
print libnum.n2s(block3_m2)

